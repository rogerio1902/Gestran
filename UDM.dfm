object DM: TDM
  OldCreateOrder = False
  Height = 330
  Width = 389
  object ImgLstGen: TImageList
    Left = 24
    Top = 16
    Bitmap = {
      494C010103005801DC0010001000FFFFFFFFFF10FFFFFFFFFFFFFFFF424D3600
      0000000000003600000028000000400000001000000001002000000000000010
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000FF990000FF9F0F00FFAC2E00FFB94F00FFC6
      6F00FFD28E000000000000000000000000000000000000000000FF990000FF99
      0000FF990000FF990000FF990000FF990000FF990000FF990000FF990000FF99
      0000FF990000FF990000FF99000000000000000000000000000000000000FF99
      0000FF990000FF990000FF990000FF990000FF990000FF990000FF990000FF99
      0000FF9900000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      000000000000000000000000000000000000FF990000FF990000FF990000FF99
      0000FF990000FF990000FF990000FF990000FF990000FF990000FF990000FF99
      0000FF990000FF990000FF990000FF99000000000000FF99000000000000FF99
      0000FF990000FF990000FF990000FF990000FF990000FF990000FF990000FF99
      0000FF990000FF990000FF99000000000000000000000000000000000000FF99
      0000000000000000000000000000000000000000000000000000000000000000
      0000FF9900000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      000000000000000000000000000000000000000000000000000000000000FF99
      0000000000000000000000000000FF990000FF990000FF990000FF990000FF99
      0000FF9900000000000000000000000000000000000000000000FF990000FF99
      0000FF990000FF990000FF990000FF990000FF990000FF990000FF990000FF99
      0000FF990000FF990000FF99000000000000000000000000000000000000FF99
      0000FF990000FF990000FF990000FF990000FF990000FF990000FF990000FF99
      0000FF9900000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      000000000000000000000000000000000000000000000000000000000000FF99
      0000000000000000000000000000FF990000FF990000FF990000FF990000FF99
      0000FF99000000000000000000000000000000000000FF99000000000000FF99
      0000FF990000FF990000FF990000FF990000FF990000FF990000FF990000FF99
      0000FF990000FF990000FF99000000000000000000000000000000000000FF99
      0000000000000000000000000000000000000000000000000000000000000000
      0000FF9900000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      000000000000000000000000000000000000000000000000000000000000FF99
      0000000000000000000000000000FF990000FF990000FF990000FF990000FF99
      0000FF9900000000000000000000000000000000000000000000FF990000FF99
      0000FF990000FF990000FF990000FF990000FF990000FF990000FF990000FF99
      0000FF990000FF990000FF99000000000000FF990000FF99000000000000FF99
      0000FF990000FF990000FF990000FF990000FF990000FF990000FF990000FF99
      0000FF99000000000000FF990000FF9900000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      000000000000000000000000000000000000000000000000000000000000FF99
      0000000000000000000000000000FF990000FF990000FF990000FF990000FF99
      0000FF99000000000000000000000000000000000000FF99000000000000FF99
      0000FF990000FF990000FF990000FF990000FF990000FF990000FF990000FF99
      0000FF990000FF990000FF99000000000000FF990000FF990000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      00000000000000000000FF990000FF9900000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      000000000000000000000000000000000000000000000000000000000000FF99
      0000000000000000000000000000FF990000FFB44300FFB44300FF990000FF99
      0000FF9900000000000000000000000000000000000000000000FF990000FF99
      0000FF990000FF990000FF990000FF990000FF990000FF990000FF990000FF99
      0000FF990000FF990000FF99000000000000FF990000FF990000FF990000FF99
      0000FF990000FF990000FF990000FF990000FF990000FF990000FF990000FF99
      0000FF990000FF990000FF990000FF9900000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      000000000000000000000000000000000000000000000000000000000000FF99
      0000000000000000000000000000FF99000000000000FFB44300FF990000FF99
      0000FF99000000000000000000000000000000000000FF99000000000000FF99
      0000FF990000FF990000FF990000FF990000FF990000FF990000FF990000FF99
      0000FF990000FF990000FF99000000000000FF990000FF990000FF990000FF99
      0000FF990000FF990000FF990000FF990000FF990000FF990000FF990000FF99
      0000FF990000FF990000FF990000FF9900000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      000000000000000000000000000000000000000000000000000000000000FF99
      0000000000000000000000000000FF990000FF990000FF990000FF990000FF99
      0000FF9900000000000000000000000000000000000000000000FF990000FF99
      0000FF990000FF990000FF990000FF990000FF990000FF990000FF990000FF99
      0000FF990000FF990000FF99000000000000FF990000FF990000FF990000FF99
      0000FF990000FF990000FF990000FF990000FF990000FF990000FF990000FF99
      0000FF990000FF990000FF990000FF9900000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      000000000000000000000000000000000000000000000000000000000000FF99
      0000000000000000000000000000FF990000FF990000FF990000FF990000FF99
      0000FF99000000000000000000000000000000000000FF99000000000000FF99
      0000FF990000FF990000FF990000FF990000FF990000FF990000FF990000FF99
      0000FF990000FF990000FF99000000000000FF990000FF990000000000000000
      0000FF990000FF990000FF990000FF990000FF990000FF990000FF990000FF99
      0000FF990000FF990000FF990000FF9900000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      000000000000000000000000000000000000000000000000000000000000FF99
      0000000000000000000000000000FF990000FF990000FF990000FF990000FF99
      0000FF9900000000000000000000000000000000000000000000FF990000FF99
      0000FF990000FF990000FF990000FF990000FF990000FF990000FF990000FF99
      0000FF990000FF990000FF99000000000000FF990000FF990000FF990000FF99
      0000FF990000FF990000FF990000FF990000FF990000FF990000FF990000FF99
      0000FF990000FF990000FF990000FF9900000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      000000000000000000000000000000000000000000000000000000000000FF99
      0000000000000000000000000000FF990000FF990000FF990000FF990000FF99
      0000FF99000000000000000000000000000000000000FF99000000000000FF99
      0000FF990000FF990000FF990000FF990000FF990000FF990000FF990000FF99
      0000FF990000FF990000FF990000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      000000000000000000000000000000000000000000000000000000000000FF99
      0000000000000000000000000000FF990000FF990000FF990000FF990000FF99
      0000FF9900000000000000000000000000000000000000000000FF990000FF99
      0000FF9900000000000000000000000000000000000000000000000000000000
      000000000000FF990000FF99000000000000000000000000000000000000FF99
      0000FF990000FF990000FF990000FF990000FF990000FF990000FF990000FF99
      0000FF9900000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      000000000000000000000000000000000000000000000000000000000000FF99
      0000000000000000000000000000FF990000FF990000FF990000FF990000FF99
      0000FF99000000000000000000000000000000000000FF99000000000000FF99
      0000FF9900000000000000000000000000000000000000000000000000000000
      000000000000FF990000FF99000000000000000000000000000000000000FF99
      0000FF990000FF990000FF990000FF990000FF990000FF990000FF990000FF99
      0000FF9900000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      000000000000000000000000000000000000000000000000000000000000FF99
      0000FF990000FF990000FF990000FF990000FF990000FF990000FF990000FF99
      0000FF9900000000000000000000000000000000000000000000FF990000FF99
      0000FF990000FF990000FF990000FF990000FF990000FF990000FF990000FF99
      0000FF990000FF990000FF99000000000000000000000000000000000000FF99
      0000FF990000FF990000FF990000FF990000FF990000FF990000FF990000FF99
      0000FF9900000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000FF990000FF9F0F00FFAC2E00FFB94F00FFC6
      6F00FFD28E0000000000000000000000000000000000FF99000000000000FF99
      0000FF990000FF990000FF990000FF990000FF990000FF990000FF990000FF99
      0000FF990000FF990000FF99000000000000000000000000000000000000FF99
      0000FF990000FF990000FF990000FF990000FF990000FF990000FF990000FF99
      0000FF9900000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      000000000000000000000000000000000000424D3E000000000000003E000000
      2800000040000000100000000100010000000000800000000000000000000000
      000000000000000000000000FFFFFF00FE07C001E00700000000A001EFF70000
      EE07C001E0070000EE07A001EFF70000EE07C00120040000EE07A0013FFC0000
      EE07C00100000000EE87A00100000000EE07C00100000000EE07A00130000000
      EE07C00100000000EE07A001FFFF0000EE07C7F9E0070000EE07A7F9E0070000
      E007C001E0070000FE07A001E007000000000000000000000000000000000000
      000000000000}
  end
  object XMLDViaCEP: TXMLDocument
    Left = 96
    Top = 16
    DOMVendorDesc = 'MSXML'
  end
  object ADOConnection: TADOConnection
    ConnectionString = 
      'Provider=SQLOLEDB.1;Integrated Security=SSPI;Persist Security In' +
      'fo=False;Initial Catalog=Gestran;Data Source=ROGERIO\SQLEXPRESS;'
    LoginPrompt = False
    Provider = 'SQLOLEDB.1'
    Left = 176
    Top = 16
  end
  object ADOQRel: TADOQuery
    Connection = ADOConnection
    CursorType = ctStatic
    Parameters = <
      item
        Name = 'D1'
        DataType = ftDateTime
        Size = -1
        Value = 0d
      end
      item
        Name = 'D2'
        DataType = ftDateTime
        Size = -1
        Value = 0d
      end
      item
        Name = 'Vendedor'
        DataType = ftString
        Size = 15
        Value = ''
      end
      item
        Name = 'Vendedor'
        DataType = ftString
        Size = 15
        Value = ''
      end
      item
        Name = 'D1'
        DataType = ftDateTime
        Size = -1
        Value = 0d
      end
      item
        Name = 'D2'
        DataType = ftDateTime
        Size = -1
        Value = 0d
      end>
    SQL.Strings = (
      'WITH WVenda AS ('
      
        '  SELECT TOP 3 Row_Number() OVER (ORDER BY Sum(Total) DESC) as N' +
        'um, Vendedor, Sum(Total) AS VendaTotal FROM Venda '
      '  WHERE DataVenda BETWEEN :D1 AND :D2'
      '  GROUP BY Vendedor '
      '  ORDER BY VendaTotal DESC'
      '),'
      'WComissao AS ('
      '  SELECT '
      '    V.Vendedor,'
      '    IIf(W.Num = 3, 5, 10) AS Comissao,'
      '    IIf(W.Num = 1, 20, 0) AS Bonificacao'
      '  FROM Venda V '
      '  LEFT JOIN WVenda W ON W.Vendedor = V.Vendedor'
      ')'
      'SELECT DISTINCT'
      '  V.Vendedor,'
      '  V.DataVenda,'
      '  V.Total,'
      '  W.VendaTotal,'
      '  C.Comissao,'
      '  C.Bonificacao,'
      '  ValorComissao = (V.Total * C.Comissao / 100) + '
      
        '    IIf(W.Num = 1, (V.Total * C.Comissao / 100) * C.Bonificacao ' +
        '/ 100, 0)'
      'FROM Venda V '
      'LEFT JOIN WVenda    W ON W.Vendedor = V.Vendedor'
      'LEFT JOIN WComissao C ON C.Vendedor = W.Vendedor'
      
        'WHERE ((V.Vendedor = :Vendedor) OR (:Vendedor = '#39#39')) AND (V.Data' +
        'Venda BETWEEN :D1 AND :D2)'
      'ORDER BY V.Vendedor, V.DataVenda')
    Left = 256
    Top = 72
  end
  object ADOQVend: TADOQuery
    Connection = ADOConnection
    Parameters = <>
    SQL.Strings = (
      'SELECT DISTINCT Vendedor FROM Venda ORDER BY Vendedor')
    Left = 256
    Top = 16
  end
  object DSRel: TDataSource
    DataSet = ADOQRel
    Left = 328
    Top = 72
  end
end
